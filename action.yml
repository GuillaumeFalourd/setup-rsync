name: 'Setup Rsync'
description: 'Github actions to setup Rsync (all os supported) ðŸ”„'

runs:
  using: "composite"
  steps:
    - name: Check OS
      id: ostype
      run: |
        if [[ $OSTYPE == 'msys'* ]]; then
          echo "Windows detected"
          echo "ostype=windows" >> $GITHUB_OUTPUT
        elif [[ $OSTYPE == 'darwin'* ]]; then 
          echo "MacOS detected"
          echo "ostype=macos" >> $GITHUB_OUTPUT
        else
          echo "Linux detected"
          echo "ostype=linux" >> $GITHUB_OUTPUT
        fi
      shell: bash

    - name: Install Rsync Windows
      if: steps.ostype.outputs.ostype == 'windows'
      uses: egor-tensin/setup-cygwin@v4
      with:
        packages: rsync
    
    - name: Install Rsync MacOS
      if: steps.ostype.outputs.ostype == 'macos'
      run: |
        echo "macos runner detected"
        brew install rsync
        echo "rsync installed on macos runner"
      shell: bash
    
    - name: Install Rsync Ubuntu
      if: steps.ostype.outputs.ostype == 'linux'
      run: |
        echo "ubuntu runner detected"
        sudo apt-get install rsync
        echo "rsync installed on ubuntu runner"
      shell: bash

    - name: Check Rsync version
      run: rsync --version
      shell: bash

branding:
  icon: arrow-right-circle
  color: blue